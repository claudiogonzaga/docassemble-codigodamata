---
features:
  javascript:
    - https://cdnjs.cloudflare.com/ajax/libs/jquery.mask/1.14.16/jquery.mask.min.js
---
objects:
  - requeridos: DAList.using(object_type=Individual)
---
question: É necessário nomear um requerido (representado, réu, suspeito da ação ilícita).
continue button field: requeridos.there_are_any
default: yes
back button: True
---
question: Adicionar mais um requerido?
yesno: requeridos.there_is_another
back button: True
---
code: |
  pessoas = requeridos.complete_elements()

---
reconsider:
  - pessoas

question: |
  Quem é o ${ ordinal(i) } requerido?
fields:
  - Nome: requeridos[i].name.first
    help: "Se não for uma petição inicial ou denúncia, não é necessário qualificar o requerido por inteiro."
  - Nacionalidade: requeridos[i].nacionalidade
    default: "de nacionalidade brasileira"
    required: False
  - Estado Civil: requeridos[i].estadocivil
    required: False
    default: ignorado
    datatype: radio
    choices:
      - solteiro(a)
      - casado(a)
      - divorciado(a)
      - viúvo(a)
      - convivente em união estável
      - ignorado

  - Ocupação: requeridos[i].ocupacao
    required: False
    hint: "Selecione uma ou escreva uma resposta"    
    datatype: combobox
    choices:
      - produtor rural
      - pecuarista
      - lavrador
      - serviços gerais
      - do lar
      - de ocupação ignorada

  - Data de Nascimento: requeridos[i].birthdate
    required: False
    datatype: date
  - Endereço: requeridos[i].address.address
    required: False
  - Número: requeridos[i].address.unit
    required: False
  - Bairro: requeridos[i].address.bairro
    required: False
  - Cidade: requeridos[i].address.city
    required: False
    hint: "Selecione uma ou escreva uma resposta"
  - Estado: requeridos[i].address.state
    required: False
    code: |
      lista_estados()
    default: "Mato Grosso"  
  - CEP: requeridos[i].address.postal_code
    required: False
  - País: requeridos[i].address.country
    code: |
      countries_list()
    default: "Brazil"
    required: False
  - CPF: requeridos[i].cpf
    required: False
  - Telefone celular: requeridos[i].mobile_number
    minlength: 13
    maxlength: 14
    validation messages:
      maxlength: |
        Formato inválido!
      minlength: |
        Formato inválido!
    hint: "(99)99999-9999"
    required: False
  - Nome da mãe: requeridos[i].nome_mae
    required: False
    default: "de filiação ignorada"
  - Usa whatsapp: requeridos[i].uses_whatsapp
    required: False
    datatype: yesno
  - qualificação em texto: requeridos[i].qualificacao
    required: False
    datatype: area
    show if:
      code: |
        False
back button: True
script: |
  <script type="text/javascript">
    $(document).ready(function(){
        $('#X2ZpZWxkXzEz').mask('000.000.000-00', {reverse: true});
        $('#X2ZpZWxkXzEx').mask('99999-999');
        $('#X2ZpZWxkXzEz').mask('(99)99999-9999');
        $('#cmVxdWVyaWRvc1tpXS5hZGRyZXNzLnBvc3RhbF9jb2Rl').mask('00000-000'); });
        $("#cmVxdWVyaWRvc1tpXS5hZGRyZXNzLnBvc3RhbF9jb2Rl").focusout(function(){ var cep = $("#cGFydFtpXS5hZGRyZXNzLnppcA").val();
        cep = cep.replace ("-","");
          if (cep != ""){ var urlStr = "https://viacep.com.br/ws/"+ cep +"/json/";
          $.ajax({ url: urlStr, crossDomain: true, type: "get", dataType: "json", success: function(data){
            $("#cmVxdWVyaWRvc1tpXS5hZGRyZXNzLmFkZHJlc3M").val(data.logradouro);
            $("#cGFydFtpXS5hZGRyZXNzLm5laWdoYm9yaG9vZA").val(data.bairro);
            $("#cGFydFtpXS5hZGRyZXNzLmNpdHk").val(data.localidade);
            $("#cGFydFtpXS5hZGRyZXNzLnN0YXRl").val(data.uf); }, error: function(erro){ console.log(erro);
    } }); } });

  </script>

---
include:
  - comum_lista_estados.yml
---
mandatory: True
code: |
  if requeridos.there_are_any:
    todos_requeridos = ''
    for requerido in requeridos:
      todos_requeridos = '' + requerido.name.full().upper() + ', '
      qualificacao_texto = "inscrito no CPF de número " + requerido.cpf + ", " + requerido.nacionalidade + ", "+ requerido.estadocivil + ", " + requerido.ocupacao + ", nascido aos " + requerido.birthdate + ", filho de " + requerido.nome_mae +  ", residente e domiciliado na " + requerido.address.address + " " + requerido.address.unit +  ", " + requeridos.address.bairro + ", " + requerido.address.city + ", " + requerido.address.state +  ", telefone: " + requerido.mobile_number +";"
      requerido.qualificacao = qualificacao_texto
    for requerido in requeridos:
      requerido.name.first = requerido.name.first.upper()
      